!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("utilities")):"function"==typeof define&&define.amd?define("mytagsupload",["utilities"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).mytagsUpload=t(e.mytags.util)}(this,function(r){"use strict";var e={props:{allow:String,clsDragover:String,concurrent:Number,maxSize:Number,method:String,mime:String,msgInvalidMime:String,msgInvalidName:String,msgInvalidSize:String,multiple:Boolean,name:String,params:Object,type:String,url:String},data:{allow:!1,clsDragover:"x-dragover",concurrent:1,maxSize:0,method:"POST",mime:!1,msgInvalidMime:"Invalid File Type: %s",msgInvalidName:"Invalid File Name: %s",msgInvalidSize:"Invalid File Size: %s Kilobytes Max",multiple:!1,name:"files[]",params:{},type:"",url:"",abort:r.noop,beforeAll:r.noop,beforeSend:r.noop,complete:r.noop,completeAll:r.noop,error:r.noop,fail:r.noop,load:r.noop,loadEnd:r.noop,loadStart:r.noop,progress:r.noop},events:{change:function(e){r.matches(e.target,'input[type="file"]')&&(e.preventDefault(),e.target.files&&this.upload(e.target.files),e.target.value="")},drop:function(e){t(e);e=e.dataTransfer;e&&e.files&&(r.removeClass(this.$el,this.clsDragover),this.upload(e.files))},dragenter:function(e){t(e)},dragover:function(e){t(e),r.addClass(this.$el,this.clsDragover)},dragleave:function(e){t(e),r.removeClass(this.$el,this.clsDragover)}},methods:{upload:function(e){var o=this;if(e.length){r.trigger(this.$el,"upload",[e]);for(var t=0;t<e.length;t++){if(this.maxSize&&1e3*this.maxSize<e[t].size)return void this.fail(this.msgInvalidSize.replace("%s",this.maxSize));if(this.allow&&!i(this.allow,e[t].name))return void this.fail(this.msgInvalidName.replace("%s",this.allow));if(this.mime&&!i(this.mime,e[t].type))return void this.fail(this.msgInvalidMime.replace("%s",this.mime))}this.multiple||(e=[e[0]]),this.beforeAll(this,e);var n=function(e,t){for(var i=[],o=0;o<e.length;o+=t){for(var n=[],a=0;a<t;a++)n.push(e[o+a]);i.push(n)}return i}(e,this.concurrent),a=function(e){var t,i=new FormData;for(t in e.forEach(function(e){return i.append(o.name,e)}),o.params)i.append(t,o.params[t]);r.ajax(o.url,{data:i,method:o.method,responseType:o.type,beforeSend:function(e){var t=e.xhr;return t.upload&&r.on(t.upload,"progress",o.progress),["loadStart","load","loadEnd","abort"].forEach(function(e){return r.on(t,e.toLowerCase(),o[e])}),o.beforeSend(e)}}).then(function(e){o.complete(e),n.length?a(n.shift()):o.completeAll(e)},function(e){return o.error(e)})};a(n.shift())}}}};function i(e,t){return t.match(new RegExp("^"+e.replace(/\//g,"\\/").replace(/\*\*/g,"(\\/[^\\/]+)*").replace(/\*/g,"[^\\/]+").replace(/((?!\\))\?/g,"$1.")+"$","i"))}function t(e){e.preventDefault(),e.stopPropagation()}return"undefined"!=typeof window&&window.mytags&&window.mytags.component("upload",e),e});